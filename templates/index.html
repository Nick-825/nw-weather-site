{% extends "base.html" %}
{% block content %}

<div class="grid lg:grid-cols-3 gap-8">
  <!-- Weather + News -->
  <section class="lg:col-span-2 space-y-8">
    <div>
      <h2 class="text-xl font-semibold mb-4">Погода (СЗФО)</h2>
      <div class="grid sm:grid-cols-2 xl:grid-cols-3 gap-5">
        {% for row in weather %}
        <div class="rounded-2xl bg-slate-900/70 ring-1 ring-white/5 p-5 shadow-soft hover:translate-y-[-2px] transition">
          <div class="flex items-start justify-between">
            <div>
              <div class="text-base font-semibold">{{ row.city }}</div>
              {% if not row.error %}
                <div class="text-4xl font-bold mt-1">{{ row.temp|round(1) }}°C</div>
                <div class="text-xs text-slate-400 mt-1">Ощущается: {{ row.feels|round(1) }}°C</div>
              {% endif %}
            </div>
            <div class="h-10 w-10 rounded-xl bg-brand-500/15 ring-1 ring-brand-400/20 grid place-items-center">
              <!-- tiny icon -->
              <svg viewBox="0 0 24 24" class="h-5 w-5"><path fill="currentColor" d="M6 14a6 6 0 1 1 11.31 3H6a3 3 0 0 1 0-6 6 6 0 0 1 0 3z"/></svg>
            </div>
          </div>

          {% if row.error %}
            <div class="text-red-400 text-sm mt-3">Ошибка: {{ row.error }}</div>
          {% else %}
            <div class="grid grid-cols-3 gap-3 text-sm mt-4">
              <div class="bg-slate-800/60 rounded-xl p-3">
                <div class="text-xs text-slate-400">Осадки</div>
                <div class="font-medium">{{ row.precip }} мм</div>
              </div>
              <div class="bg-slate-800/60 rounded-xl p-3">
                <div class="text-xs text-slate-400">Ветер</div>
                <div class="font-medium">{{ row.wind }} м/с</div>
              </div>
              <div class="bg-slate-800/60 rounded-xl p-3">
                <div class="text-xs text-slate-400">Направление</div>
                <div class="font-medium">{{ row.wdir }}°</div>
              </div>
            </div>
          {% endif %}
        </div>
        {% endfor %}
      </div>
    </div>

    <div id="news">
      <h2 class="text-xl font-semibold mb-4">Новости</h2>
      <div class="space-y-3">
        {% for n in headlines %}
        <a class="block rounded-2xl bg-slate-900/70 ring-1 ring-white/5 p-5 hover:bg-slate-900 transition"
           href="{{ n.link }}" target="_blank" rel="noopener">
          <div class="text-xs text-slate-400">{{ n.source }} • {{ n.published }}</div>
          <div class="font-medium mt-1">{{ n.title }}</div>
        </a>
        {% endfor %}
      </div>
    </div>
  </section>

  <!-- Rates -->
  <aside id="rates" class="space-y-4">
    <h2 class="text-xl font-semibold">Курсы ЦБ РФ</h2>
    <div class="rounded-2xl bg-slate-900/70 ring-1 ring-white/5 p-5 space-y-4">
      {% for code, r in rates.items() %}
      <div class="flex items-center justify-between">
        <div>
          <div class="font-medium">{{ code }}</div>
          <div class="text-xs text-slate-400">{{ r.name }}</div>
        </div>
        <div class="text-lg font-semibold">{{ '%.4f'|format(r.value) }}</div>
      </div>
      {% endfor %}
    </div>
  </aside>
</div>

{% endblock %}
